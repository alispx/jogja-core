!function(t){"use strict";var e=t.fn.addClass;t.fn.addClass=function(){var t=e.apply(this,arguments);return"BODY"==this.prop("tagName")&&"folded"==arguments[0]&&calculatePositionAndSize(),t};var a=t.fn.removeClass;t.fn.removeClass=function(){var t=a.apply(this,arguments);return"BODY"==this.prop("tagName")&&"folded"==arguments[0]&&calculatePositionAndSize(),t},vp.custom_check_radio_event(".vp-wrap",".vp-field.vp-checked-field .field .input label"),t(document).on("ready",function(){vp.init_controls(t(".vp-wrap"))});var n,r=[],s=[],i=[],o=[];t(".vp-menu-goto").each(function(e){var a=t(this).attr("href"),p=t(a),l=[];p.children(".vp-field").each(function(e){var a=t(this),r=a.attr("id"),p=a.attr("data-vp-validation"),d=a.attr("data-vp-bind"),v=a.attr("data-vp-items-bind"),c=a.getDatas().type;t('[name="'+r+'"]');n=a.attr("data-vp-dependency"),n&&o.push({dep:n,type:"field",source:a.attr("id")}),d&&s.push({bind:d,type:c,source:r}),v&&i.push({bind:v,type:c,source:r}),p&&l.push({name:r,rules:p,type:c})}),p.children(".vp-section").each(function(e){var a=t(this);n=a.attr("data-vp-dependency"),n&&o.push({dep:n,type:"section",source:a.attr("id")}),a.find(".vp-field").each(function(e){var a=t(this),r=a.attr("id"),p=a.attr("data-vp-validation"),d=a.attr("data-vp-bind"),v=a.attr("data-vp-items-bind"),c=a.getDatas().type;t('[name="'+r+'"]');n=a.attr("data-vp-dependency"),n&&o.push({dep:n,type:"field",source:a.attr("id")}),d&&s.push({bind:d,type:c,source:r}),v&&i.push({bind:v,type:c,source:r}),p&&l.push({name:r,rules:p,type:c})})}),l.length>0&&r.push({name:a.trimChar("#"),fields:l})}),t(".vp-js-menu-goto").click(function(e){e.preventDefault(),window.location.hash="#_"+t(this).attr("href").substr(1);var a=t(this),n=a.parent("li"),r=n.parents("li"),s=n.siblings("li"),i=r.siblings("li"),o=t(a.attr("href"));s.removeClass("vp-current"),i.removeClass("vp-current"),r.addClass("vp-current"),n.addClass("vp-current"),o.siblings(".vp-panel").removeClass("vp-current"),o.addClass("vp-current")});var p=window.location.hash;""!==p?(p="#"+p.substr(2),t('a[href="'+p+'"]').trigger("click")):t(".vp-current > .vp-js-menu-goto").click(),t(".vp-js-menu-dropdown").click(function(e){e.preventDefault();var a=t(this),n=a.parent("li"),r=n.siblings("li"),s=a.next("ul");n.hasClass("vp-current")||(r.removeClass("vp-current"),n.addClass("vp-current"),s.children("li.vp-current").exists()?s.children("li.vp-current").children("a").click():s.children("li").first().children("a").click())});for(var l=0;l<s.length;l++){var d=s[l],v=d.bind.split("|"),c=v[0],u=v[1],f=[];u=u.split(/[\s,]+/);for(var m=0;m<u.length;m++)f.push(u[m]);for(var m=0;m<f.length;m++)vp.binding_event(f,m,d,c,".vp-wrap","option")}for(var l=0;l<i.length;l++){var d=i[l],v=d.bind.split("|"),c=v[0],u=v[1],f=[];u=u.split(/[\s,]+/);for(var m=0;m<u.length;m++)f.push(u[m]);for(var m=0;m<f.length;m++)vp.items_binding_event(f,m,d,c,".vp-wrap","option")}for(var l=0;l<o.length;l++){var d=o[l],v=d.dep.split("|"),c=v[0],u=v[1],f=[];u=u.split(",");for(var m=0;m<u.length;m++)f.push(u[m]);for(var m=0;m<f.length;m++)vp.dependency_event(f,m,d,c,".vp-wrap")}t(".vp-js-option-form").bind("submit",function(e){e.preventDefault(),vp.tinyMCE_save(),t(".vp-js-option-form .vp-field").removeClass("vp-error"),t(".validation-notif.vp-error").remove(),t(".validation-msg.vp-error").remove();for(var a=0,n='<em class="validation-notif vp-error"></em>',s=0;s<r.length;s++){var i=r[s];if(i.nError=0,i.nError=vp.fields_validation_loop(i.fields),i.nError>0){var o=t(n),p=t('[href="#'+i.name+'"]'),l=p.parent("li").parent("ul");o.appendTo(p),l.hasClass("vp-menu-level-2")&&0===l.siblings("a").children(".validation-notif.vp-error").length&&o.clone().appendTo(l.siblings("a"))}a+=i.nError}if(!(a>0)){var d=t(".vp-js-save-loader"),v=t(this).find(".vp-save"),c=t(".vp-js-save-status"),u=t("#vp-option-form"),f=u.serializeArray(),m={action:"vp_ajax_"+vp_opt.name+"_save",option:f,nonce:vp_opt.nonce};v.attr("disabled","disabled"),d.stop(!0,!0).fadeIn(100),t.post(ajaxurl,m,function(t){c.html(t.message),t.status?c.addClass("success"):c.addClass("failed"),d.stop(!0,!0).fadeOut(100,function(){c.stop(!0,!0).fadeIn(100)}),setTimeout(function(){v.removeAttr("disabled"),c.stop(!0,!0).fadeOut(1e3,function(){c.removeClass("success").removeClass("failed")})},3e3)},"JSON")}}),t(".vp-js-restore").bind("click",function(e){if(e.preventDefault(),confirm("The current options will be deleted, do you want to proceed?")){var a=t(this),n=a.parent(),r=n.find(".vp-js-status"),s=n.find(".vp-js-loader"),i={action:"vp_ajax_"+vp_opt.name+"_restore",nonce:vp_opt.nonce};a.attr("disabled","disabled"),s.fadeIn(100),t.post(ajaxurl,i,function(t){switch(s.fadeOut(0),t.code){case parseInt(vp_opt.SAVE_SUCCESS):r.html(vp_opt.util_msg.restore_success);break;case parseInt(vp_opt.SAVE_NOCHANGES):r.html(vp_opt.util_msg.restore_nochanges);break;case parseInt(vp_opt.SAVE_FAILED):r.html(vp_opt.util_msg.restore_failed+": "+t.message)}r.fadeIn(100),setTimeout(function(){r.fadeOut(1e3,function(){a.removeAttr("disabled"),r.fadeOut(500),t.code==parseInt(vp_opt.SAVE_SUCCESS)&&location.reload()})},2e3)},"JSON")}}),t("#vp-js-import").bind("click",function(e){e.preventDefault();var a=t("#vp-js-import_text"),n=t("#vp-js-import-status"),r=t("#vp-js-import-loader"),s=t(this),i={action:"vp_ajax_"+vp_opt.name+"_import_option",option:a.val(),nonce:vp_opt.nonce};s.attr("disabled","disabled"),r.fadeIn(100),t.post(ajaxurl,i,function(t){r.fadeOut(0),t.status?n.html(vp_opt.util_msg.import_success):n.html(vp_opt.util_msg.import_failed+": "+t.message),n.fadeIn(100),setTimeout(function(){n.fadeOut(1e3,function(){s.removeAttr("disabled"),n.fadeOut(500),t.status&&location.reload()})},2e3)},"JSON")}),t("#vp-js-export").bind("click",function(e){e.preventDefault();var a=t("#vp-js-export-status"),n=t("#vp-js-export-loader"),r=t(this),s={action:"vp_ajax_"+vp_opt.name+"_export_option",nonce:vp_opt.nonce};r.attr("disabled","disabled"),n.fadeIn(100),t.post(ajaxurl,s,function(e){n.fadeOut(0),!t.isEmptyObject(e.option)&&e.status?(t("#vp-js-export_text").val(e.option),a.html(vp_opt.util_msg.export_success)):a.html(vp_opt.util_msg.export_failed+": "+e.message),a.fadeIn(100),setTimeout(function(){a.fadeOut(1e3,function(){r.removeAttr("disabled"),a.fadeOut(500)})},3e3)},"JSON")})}(jQuery);